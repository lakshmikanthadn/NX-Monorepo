import TokenDecoder from './TokenDecoder';
import { expect } from 'chai';
const differentTokens = {
  anonymous:
    'eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpcCI6IiIsImNvdW50cnlfY29kZSI6IiIsInNjb3BlIjpbInByb2R1Y3RfYWNjZXNzIl0sInIiOlsiQlVTIl0sInRlcnJpdG9yeV90eXBlIjoiY291bnRyeSIsInVzZXIiOnsib3JnYW5pemF0aW9uTmFtZSI6bnVsbCwib3JnYW5pemF0aW9uSWQiOm51bGwsInVzZXJUeXBlIjoiYW5vbnltb3VzIn0sImlzcyI6Imh0dHBzOi8vYWNjb3VudHMudGF5bG9yZnJhbmNpcy5jb20vaWRlbnRpdHkvIiwiZXhwIjoxNjMyODEzNjU3LCJpYXQiOjE2MzI4MTAwNTcsImF1ZCI6IjFlNTc2ZDFhNmZhNzFlMjg4YTViMTI1ZmJlZDBhOGIxNDZhYmI3Mzg5MWU4MWNkODVlMTJjYTZkMzM1MGExZGEifQ.bOFmuQTlQXn2m0Ij_QsfJrXVvKJ40oxD0Ou_uUcFF1FojWi1eUsu7wuBmm47pdC_GDiJMkCrigL14d9LjjwaLIy2UJkzKUxTf7cv3C3VgMOqnyK5plsO8tM-qR2qSKgOBNaG6nfFuEW_HVJ5aPhnW0rf_yvrBAcXF3YO5wZ1ZGlD9rWITLh72wlt6FOYICjd1FfK96sliQAQ_LIE2eH6rKgpN3fLhMsyE4jNO27_n1Hf7aZctxc24KtGjZwxfgLsSquzpR2m038Qlge8JYwtMoKpaPROsbUolFk4_8Ql_KZf6bbmmUBGWF-MtToJL52uzf99b0t_GHUhIiypqpjK6w',
  anonymous_ip:
    'eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpcCI6IjE1Ny41MC4xNS4xNDEiLCJjb3VudHJ5X2NvZGUiOiJJTiIsInNjb3BlIjpbInByb2R1Y3RfYWNjZXNzIl0sInIiOlsiQlVTIl0sInRlcnJpdG9yeV90eXBlIjoiY291bnRyeSIsInVzZXIiOnsidXNlclR5cGUiOiJpcCIsIl9pZCI6IjYxNTJhZDYwMzdlMTdjMDAxZjBmNWE3NiIsInVzZXJuYW1lIjoiMTU3LjUwLjE1LjE0MSIsImVtYWlsIjoiYW5ub255bW91cyIsImRpc3BsYXlOYW1lIjoiIiwiaGFzQWNjZXB0ZWRUZXJtcyI6ZmFsc2UsIm1GQUF1dGhlbnRpY2F0ZWQiOmZhbHNlLCJvcmdhbml6YXRpb25OYW1lIjpudWxsLCJvcmdhbml6YXRpb25JZCI6bnVsbH0sImlzcyI6Imh0dHBzOi8vYWNjb3VudHMudGF5bG9yZnJhbmNpcy5jb20vaWRlbnRpdHkvIiwiZXhwIjoxNjMyODExODg5LCJpYXQiOjE2MzI4MDgyODksImF1ZCI6IjFlNGE3MTI3ZDc5ZTgzNzIxNGJhNjQzMTU2ZTM3ZjU5OWQwYzJjZDE1YzY5ZDFiMmQzMWNkY2Y5ZWUyMjc5ZDAiLCJzdWIiOiI2MTUyYWQ2MDM3ZTE3YzAwMWYwZjVhNzYifQ.KFaCQwWDfpr6FaT-dp3SmXAdqu8Wkv-UXrINP8LvbZBtnSCaqnTgrZhoEH1Ge7iuvqnI2sSvQnfSqZCpctEEX7Vqrjy4SCrUlHsQoe0qm6Gg-rauVQJxCG2zgpPYw6W1bdE-ZHkEjMD1Knho1Z60IRWDjnRI4wAMLjsaHik4twr0lOfkXgKHPnOuEIrihDpZxPWLm13fofuz2wPdwQ6r0Jhkrl6lsZZyn24IHlLS_gb2AtNdiPNkG9c7PX4-xKn93mx0-YG_8BMFzNj2oFVd6Vq91IHuvHXbrxk9x5zfGuqqdJfkGe8TL7FXIns75NAKP_HfUn2hTI66Do6DmorJ6w',
  client:
    'eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpcCI6IiIsInNjb3BlIjpbInByb2R1Y3RfYWNjZXNzIl0sInRlcnJpdG9yeV90eXBlIjoiY291bnRyeSIsImNsaWVudCI6eyJyZWRpcmVjdF91cmlzIjpbImh0dHBzOi8vYXBpLnRheWxvcmZyYW5jaXMuY29tL3Y0L2NvbnRlbnQvY2FsbGJhY2siXSwiX2lkIjoiNjA0MjJlMDYyNGFkOTYwMDFmYTcwNjEzIiwidXNlcm5hbWUiOiJwY21AaW5mb3JtYS5jb20iLCJuYW1lIjoiUENNLUFQSS1BUFAiLCJjbGllbnRJZCI6IjFlNTc2ZDFhNmZhNzFlMjg4YTViMTI1ZmJlZDBhOGIxNDZhYmI3Mzg5MWU4MWNkODVlMTJjYTZkMzM1MGExZGEifSwiciI6WyJCVVMiXSwiaXNzIjoiaHR0cHM6Ly9hY2NvdW50cy50YXlsb3JmcmFuY2lzLmNvbS9pZGVudGl0eS8iLCJleHAiOjE2MzI4MTMzODUsImlhdCI6MTYzMjgwOTc4NSwiYXVkIjoiMWU1NzZkMWE2ZmE3MWUyODhhNWIxMjVmYmVkMGE4YjE0NmFiYjczODkxZTgxY2Q4NWUxMmNhNmQzMzUwYTFkYSIsInN1YiI6bnVsbH0.CbCf2NYj3TVoAgvGcvzEQuDQpsRyNhtgoyY3o71cz1hIr7a1vZI5QaQlbXE4Ikkpb8XHu91zaSl2DQmW9XjLSGHuy-7nsa9ywpxQlZecgb78BIuu2p-yJhGxbb6pKlCRY75PL9HRr_Lj9sPRJaqRf1Ua7hjrFRLc5T7eg6fzauR6aebYDcXFz6W3TSEB1H3Zg_MH1I3r9N-Xkq2nEipLnjnosuCWDJH1xghKwMNTd1KPttuf4hgJWCf51tdnJ4CJIq0lysQxHzB8732Y7taxlnuYw4C3ELzpzNqFUq1xuvxqgTumIXu8gVPW05c3rzv6exjL1rmBcxqsym0hvfdKQQ',
  ip: 'eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpcCI6IjEzMC4xMTcuMTI0LjEwIiwiY291bnRyeV9jb2RlIjoiR0IiLCJzY29wZSI6WyJwcm9kdWN0X2FjY2VzcyJdLCJyIjpbIkJVUyJdLCJ0ZXJyaXRvcnlfdHlwZSI6ImNvdW50cnkiLCJ1c2VyIjp7InVzZXJUeXBlIjoiaXAiLCJfaWQiOiI2MTUxNWI2NTM3ZTE3YzAwMWYwNzk3NzEiLCJ1c2VybmFtZSI6IjEzMC4xMTcuMTI0LjEwIiwib3JnYW5pemF0aW9uSWQiOiIxMDAiLCJvcmdhbml6YXRpb25OYW1lIjoiVGF5bG9yICYgRnJhbmNpcyBHcm91cCJ9LCJpc3MiOiJodHRwczovL2FjY291bnRzLnRheWxvcmZyYW5jaXMuY29tL2lkZW50aXR5LyIsImV4cCI6MTYzMjc1NjM2NSwiaWF0IjoxNjMyNzUyNzY1LCJhdWQiOiIxZTRhNzEyN2Q3OWU4MzcyMTRiYTY0MzE1NmUzN2Y1OTlkMGMyY2QxNWM2OWQxYjJkMzFjZGNmOWVlMjI3OWQwIiwic3ViIjoiNjE1MTViNjUzN2UxN2MwMDFmMDc5NzcxIn0.B4r4qzTBZJWrc-EvjMmW7HMbBSkYmMC3iPYYivNHYapzg8QxKT9_vzR_TtMpEjptzpYhAe3H4mB3ZP5VzWGIp4DaYAZs4KlAU0GY3WTnsxuUd6fA0QbBWRtRrHjuO7T7ukG02hDjs6VlrGbltIBmP3C6mBQFQRlzrdZnr_EVjwM0GRlIpcXElzl9tpIwAizMHC1B4nie_eX3Zmf2cQerytAYMomD4ziVaRxOEl9WaneM1hpjZX32dvS6CfvHdW_b5LsENyAtlVbP0kWVh6IlCrUBbNB3C8dCXVEppwKH0RokHnlPp3n_oUGFkKOp3iUPpLsIE67MS2oxrLaAWUzQ1A',
  service:
    'eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpcCI6Ijg1LjIyMi4xNTAuOCIsImNvdW50cnlfY29kZSI6IkdCIiwic2NvcGUiOlsicHJvZHVjdF9hY2Nlc3MiXSwiciI6WyJBRE4iLCJQU0ZBIl0sInRlcnJpdG9yeV90eXBlIjoiY291bnRyeSIsInVzZXIiOnsiX2lkIjoiNWRmODlkMjZkZWJlY2QyMDAwZTZiN2JiIiwiZW1haWwiOiJzYWxlc2ZvcmNlLWRldnByb2RwYWMtOWVjY2FiMjAtN2VmMy00MWM5LTk4ZTktYzVjZWZlYjQzY2Q5QHNlcnZpY2UtYWNjb3VudHMuaW5mb3JtYS5jb20iLCJvcmdhbml6YXRpb25OYW1lIjoiVGVzdCAtIHVwZGF0ZV9zZmRjIiwib3JnYW5pemF0aW9uSWQiOiI1MTExNiIsInBhcnR5SWQiOiJzYWxlc2ZvcmNlLWRldnByb2RwYWMtOWVjY2FiMjAtN2VmMy00MWM5LTk4ZTktYzVjZWZlYjQzY2Q5QHNlcnZpY2UtYWNjb3VudHMuaW5mb3JtYS5jb20ifSwiaXNzIjoiaHR0cHM6Ly9hY2NvdW50cy1kZXYudGF5bG9yZnJhbmNpcy5jb20vaWRlbnRpdHkvIiwiZXhwIjoxNjMyMzg3Nzc4LCJpYXQiOjE2MzIzODQxNzgsImF1ZCI6IjA5NTNhMzhiOTliOTk1NjUxZDg0YmE0NjBiYzJjNDY4YjdlZDUzZGYwN2RiOTBkMWQ1NGY3MTU5ZjkyMDAxNzIiLCJzdWIiOiI1ZGY4OWQyNmRlYmVjZDIwMDBlNmI3YmIifQ.bAUz9qw4J0X2XHC6feZhJubd58JyeVG2Qj476LdFdcr_9cul9Jo7G-P7ZA7bIIecLH_Pb3ljv8dDJtB2lbhmV489M-U0tcutcbr7xqgk-Ef_v-KNHVjENQf8GGhZ-qVAHBgiDLsg-Dc4chmBSzHFDrzmU9K9DlL-bPoxxgaxhV8uVOw0D3KWElFk7-R-gIT_aoK6-sX0ZmIjxLqveeuGcd8w-uaOWVPf3Euu2ZYjcVPuhUl8aP_W2MkzhJ5wP_4dWuy612Bg6aYfqtDSLZrUoyW5pkDtKQog6BCV2kARyYg-zrMvjD0KeKfOEKYasAE1BDEru2FFNPZbhKwWpAH6BA',
  user: 'eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpcCI6IjEzMC4xMTcuMTI0LjEwIiwiY291bnRyeV9jb2RlIjoiR0IiLCJzY29wZSI6WyJwcm9kdWN0X2FjY2VzcyJdLCJyIjpbIkJVUyJdLCJ0ZXJyaXRvcnlfdHlwZSI6ImNvdW50cnkiLCJ1c2VyIjp7InVzZXJUeXBlIjoidXNlciIsIl9pZCI6IjYwZjdjZTRjMWUzNWZmMDAxZjk1YWJkMSIsInVzZXJuYW1lIjoibGFrc2htaWthbnRoYS5kbkBpbmZvcm1hLmNvbSIsImVtYWlsIjoibGFrc2htaWthbnRoYS5kbkBpbmZvcm1hLmNvbSIsImRpc3BsYXlOYW1lIjoiTGFrc2htaSBLYW50aGEiLCJvcmdhbml6YXRpb25OYW1lIjoiVGF5bG9yICYgRnJhbmNpcyBHcm91cCIsImhhc0FjY2VwdGVkVGVybXMiOnRydWUsIm1GQUF1dGhlbnRpY2F0ZWQiOnRydWUsIm9yZ2FuaXphdGlvbklkIjoiMTAwIiwicGFydHlJZCI6Njg3MDg3NX0sImlzcyI6Imh0dHBzOi8vYWNjb3VudHMudGF5bG9yZnJhbmNpcy5jb20vaWRlbnRpdHkvIiwiZXhwIjoxNjMyODEyNDA4LCJpYXQiOjE2MzI4MDg4MDgsImF1ZCI6IjFlNGE3MTI3ZDc5ZTgzNzIxNGJhNjQzMTU2ZTM3ZjU5OWQwYzJjZDE1YzY5ZDFiMmQzMWNkY2Y5ZWUyMjc5ZDAiLCJzdWIiOiI2MGY3Y2U0YzFlMzVmZjAwMWY5NWFiZDEifQ.cFMurzEQAEAXKam4RVgSjFD4TS8w-T7krc-CuXvni53s0gcr6cmzbYBKogSVyBKjtfBByQoUMn8CIDzefnTNFXw6J87VSzqMYEZHsLGeFPHuDDf8Bm3VE1v6_Dr2RghZJQr-T69lPjzZF9c0dlbgWmOyjwFuC10iht-zJxeFbQpJC8DPJwn3hRrTPTEkuNC-Ny8U-VtXufiYoQbzQ7ARLqKmr_m2ZrWO8ibiUYqjitcyphJO6gsjzxBhlIg36YskrXvoA-CdgQCZPV0c22IdI-z7ohwgmVJc9bzgkuBel9Pkf62nenu9Jx16K0RkmAIF-pdDIdfnjpcpXMNWdPqICQ'
};

describe('tokenDecoder', () => {
  it('should return anonymous when anonymous token passed', () => {
    const tokenDecoder = new TokenDecoder(differentTokens.anonymous);
    expect(tokenDecoder.getTokenIdentity()).to.eql('annonymous');
  });
  it('should return anonymous_ip when anonymous ip token passed', () => {
    const tokenDecoder = new TokenDecoder(differentTokens.anonymous_ip);
    expect(tokenDecoder.getTokenIdentity()).to.eql(
      'annonymous - 157.50.15.141'
    );
  });
  it('should return org name when logged token passed', () => {
    const tokenDecoder = new TokenDecoder(differentTokens.ip);
    expect(tokenDecoder.getTokenIdentity()).to.eql('Taylor & Francis Group');
  });
  it('should return anonymous when anonymous token passed', () => {
    const tokenDecoder = new TokenDecoder(differentTokens.user);
    expect(tokenDecoder.getTokenIdentity()).to.eql('Taylor & Francis Group');
  });
  it('should return anonymous when anonymous token passed', () => {
    const tokenDecoder = new TokenDecoder(differentTokens.service);
    expect(tokenDecoder.getTokenIdentity()).to.eql('Test - update_sfdc');
  });
  it('should return anonymous when anonymous token passed', () => {
    const tokenDecoder = new TokenDecoder(differentTokens.client);
    expect(tokenDecoder.getTokenIdentity()).to.eql('pcm@informa.com');
  });
  it('should return undefined when empty token passed', () => {
    const tokenDecoder = new TokenDecoder('');
    expect(tokenDecoder.getTokenIdentity()).to.eql(undefined);
  });
});
